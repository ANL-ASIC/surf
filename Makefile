# Makefile automatically generated by ghdl
# Version: GHDL 0.34-dev (2017-03-01) [Dunoon edition] - mcode code generator
# Command used to generate this makefile:
# ghdl --gen-makefile -v -P/afs/slac/g/reseng/vol20/ghdl/lib/ghdl/vendors/xilinx-vivado/ --workdir=work --ieee=synopsys -fexplicit -frelaxed-rules AxiLiteCrossbar

GHDL=ghdl
GHDLFLAGS= -P/afs/slac/g/reseng/vol20/ghdl/lib/ghdl/vendors/xilinx-vivado/ --workdir=work --ieee=synopsys -fexplicit -frelaxed-rules
GHDLRUNFLAGS=

PATHS = base/*/rtl/*.vhd \
axi/rtl/*.vhd \
devices/*/*/rtl/*.vhd  devices/*/rtl/*.vhd \
protocols/*/rtl/*.vhd protocols/*/*/rtl/*.vhd \
xilinx/*/*/rtl/*.vhd xilinx/*/rtl/*.vhd \
ethernet/*/*/*/rtl/*.vhd ethernet/*/*/rtl/*.vhd ethernet/*/rtl/*.vhd 

EXCLUDE = $(wildcard protocols/i2c/rtl/orig/*) \
$(wildcard ethernet/XauiCore/gth7/rtl/*.vhd) \
$(wildcard ethernet/XauiCore/gtx7/rtl/*.vhd) \
$(wildcard xilinx/Virtex5/gtp/rtl/*.vhd)

FILES = $(filter-out $(EXCLUDE),$(wildcard $(PATHS)))
#FILES = $(shell find . -type f -wholename '*/rtl/*.vhd' -not -wholename '*/orig/*.vhd')
#PATHS=base/*/rtl/*.vhd axi/rtl/*.vhd ethernet/**/rtl/*.vhd protocols/*/**/rtl/*.vhd
ENTITIES := $(filter-out stdlib,$(patsubst %Pkg,,$(patsubst %.vhd,%,$(notdir $(wildcard $(PATHS))))))
MAKEFILES = $(patsubst %,%.mk,$(ENTITIES))

$(info EXCLUDE="$(EXCLUDE)")
#$(info FILES="$(FILES)")
#$(info ENTITIES="$(ENTITIES)")


all: $(ENTITIES) $(MAKEFILES)

force:

clean :
	$(GHDL) --clean $(GHDLFLAGS)

import : $(FILES)
	$(GHDL) -i $(GHDLFLAGS) $(FILES)


$(ENTITIES) : import
	$(GHDL) -m $(GHDLFLAGS) $@

html : $(FILES)
	$(GHDL) --xref-html $(GHDLFLAGS) $(FILES)

$(MAKEFILES) : import
	$(GHDL) --gen-makefile $(GHDLFLAGS) $(patsubst %.mk,%,$@)
